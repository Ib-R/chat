(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[3],{40:function(e,t,a){"use strict";a.r(t);var n,o=a(7),s=a(8),c=a(10),r=a(9),l=a(0),i=a.n(l),m=a(11),d=window.io.connect("//"+Object(m.a)("server"));function u(){var e=document.querySelector("#chat");e.scrollTop=e.scrollHeight}var g=function(){d.emit("typing",Object(m.a)("username"))};d.on("typing",(function(e){var t=document.querySelector("#typing"),a=document.getElementById("membersCount");a.classList.add("d-none"),t.innerHTML=e+" is typing...",clearTimeout(n),n=setTimeout((function(){t.innerHTML="",a.classList.remove("d-none")}),700)})),d.on("roomUsers",(function(e){!function(e){var t,a=document.getElementById("roomName"),n=document.getElementById("membersCount"),o=document.getElementById("members");a.innerHTML="",o.innerHTML="",a.insertAdjacentHTML("beforeend",(t=e.room).charAt(0).toUpperCase()+t.slice(1)),n.innerHTML="".concat(e.users.length," members"),e.users.forEach((function(e,t){o.insertAdjacentHTML("beforeend","<li>".concat(e.username,"</li>"))}))}(e)}));var f=function(e){var t=document.querySelector("#imgUploadInput"),a=new FormData;null!=t.files[0]&&(a.append("img",t.files[0]),a.append("username",Object(m.a)("username")),fetch("//"+Object(m.a)("server")+"/upload",{body:a,method:"POST"}).then((function(e){return e.json()})).then((function(e){})).catch((function(){alert("error")}))),console.log(t.files[0])};function p(e){var t,a=document.querySelector("#message");e.preventDefault(),t={msg:a.value,user:Object(m.a)("username")},d.emit("send message",t),a.value=""}d.on("new message",(function(e){var t,a,n=document.querySelector("#chat");e.user===Object(m.a)("username")?n.insertAdjacentHTML("beforeend",'<div class="float-right own-msg bg-secondary">\n                <strong class="username">'.concat(e.user,'</strong>\n                <p class="text-light">').concat(e.msg," <small>").concat(e.time,'</small></p>\n            </div>\n            <div class="clearfix"></div>')):(n.insertAdjacentHTML("beforeend",'<div class="bg-primary float-left msg"><p class="text-light"><strong>'+e.user+"</strong>: "+e.msg+'</p></div><div class="clearfix"></div>'),t="You Got new Message",a="New Message",document.hasFocus()||window.Push.create(a,{body:t,icon:"https://image.flaticon.com/teams/slug/freepik.jpg",timeout:4e3,onClick:function(){window.focus(),this.close()}})),u()})),d.on("show image",(function(e){var t=document.querySelector("#chat");e.user===Object(m.a)("username")?t.insertAdjacentHTML("beforeend",'<div class="float-right own-msg bg-secondary">\n                <a data-fancybox="ownGallery" href="//'.concat(Object(m.a)("server"),"/uploads/").concat(e.msg,'">\n                    <figure class="figure">\n                        <img id="img" src="//').concat(Object(m.a)("server"),"/uploads/").concat(e.msg,'">\n                        <figcaption class="figure-caption d-flex justify-content-between">\n                            <strong>').concat(e.user,"</strong> \n                            <small>").concat(e.time,'</small>\n                        </figcaption>\n                    </figure>\n                </a>\n            </div>\n            <div class="clearfix"></div>')):t.insertAdjacentHTML("beforeend",'<div class="bg-primary float-left msg">\n                <a data-fancybox="gallery" href="//'.concat(Object(m.a)("server"),"/uploads/").concat(e.msg,'">\n                    <figure class="figure">\n                        <img id="img" src="//').concat(Object(m.a)("server"),"/uploads/").concat(e.msg,'">\n                        <figcaption class="figure-caption d-flex justify-content-between">\n                            <strong>').concat(e.user,"</strong>\n                            <small>").concat(e.time,'</small>\n                        </figcaption>\n                    </figure>\n                </a>\n            </div>\n            <div class="clearfix"></div>')),u()}));var b=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.room;d.connect(),d.emit("joinRoom",{username:Object(m.a)("username"),room:e})}},{key:"componentDidUpdate",value:function(e){var t=this.props.room;e.room!==t&&(d.disconnect(),d.connect(),d.emit("joinRoom",{username:Object(m.a)("username"),room:t}))}},{key:"componentWillUnmount",value:function(){d.disconnect()}},{key:"render",value:function(){var e=this.props,t=e.logout,a=e.room;return i.a.createElement("div",null,i.a.createElement("div",{id:"chat-h",className:"fixed-top"},i.a.createElement("span",{onClick:t,className:"btn btn-danger float-right"},"Logout"),i.a.createElement("div",{id:"roomHead"},i.a.createElement("p",{id:"roomName"},a),i.a.createElement("small",{id:"membersCount","data-toggle":"modal","data-target":"#membersModal"}),i.a.createElement("small",{id:"typing"}))),i.a.createElement("div",{className:"modal fade",id:"membersModal",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},i.a.createElement("div",{className:"modal-dialog",role:"document"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"Room Members"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("div",{className:"modal-body"},i.a.createElement("ul",{id:"members"})),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal"},"Close"))))),i.a.createElement("div",{id:"messageArea",className:"container row"},i.a.createElement("ul",{className:"chat",id:"chat"}),i.a.createElement("div",{className:"fixed-bottom row justify-content-md-center"},i.a.createElement("form",{onSubmit:p,id:"messageForm",className:"col col-md-8 row",autoComplete:"off"},i.a.createElement("label",{className:"sr-only"},"Enter Message"),i.a.createElement("input",{onInput:g,name:"message",type:"text",className:"form-control",id:"message",placeholder:"Enter Message"}),i.a.createElement("input",{type:"submit",className:"btn btn-primary",id:"msg-submit",value:"Send"}),i.a.createElement("label",{id:"imgBtn",className:"btn btn-primary",htmlFor:"imgUploadInput"},"\u26f6"),i.a.createElement("input",{onChange:f,type:"file",style:{display:"none"},name:"img",id:"imgUploadInput"})))),i.a.createElement("iframe",{title:"background",style:{position:"absolute",width:"100%",height:"100%",top:"0",border:"none"},src:"".concat("/chat","/bg/index.html")}))}}]),a}(l.Component);t.default=b}}]);
//# sourceMappingURL=3.bf92c165.chunk.js.map