{"version":3,"sources":["util/socket.js","components/Room.js"],"names":["timer","socket","window","io","connect","GetCookie","updateScroll","$chat","document","querySelector","scrollTop","scrollHeight","Typing","emit","on","data","$typing","membersCount","getElementById","classList","add","innerHTML","clearTimeout","setTimeout","remove","string","roomName","members","insertAdjacentHTML","room","charAt","toUpperCase","slice","users","length","forEach","user","i","username","updateRoomDetails","imgUpload","e","$imgUpload","FormData","files","append","fetch","body","method","then","res","json","catch","alert","console","log","messageSubmit","$message","preventDefault","msg","value","theBody","theTitle","time","hasFocus","Push","create","icon","timeout","onClick","focus","this","close","Room","props","prevProps","disconnect","logout","id","className","data-toggle","data-target","tabIndex","role","aria-labelledby","aria-hidden","type","data-dismiss","aria-label","onSubmit","autoComplete","onInput","name","placeholder","htmlFor","onChange","style","display","title","position","width","height","top","border","src","Component"],"mappings":"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","file":"static/js/3.bb45006b.chunk.js","sourcesContent":["import {GetCookie} from \"./util\"\r\nexport const socket = window.io.connect('//'+GetCookie('server'));\r\n\r\nvar timer;\r\n\r\nfunction updateRoomDetails(data) {\r\n    const roomName = document.getElementById(\"roomName\"),\r\n    membersCount = document.getElementById(\"membersCount\"),\r\n    members = document.getElementById(\"members\");\r\n\r\n    roomName.innerHTML = \"\";\r\n    members.innerHTML = \"\";\r\n    roomName.insertAdjacentHTML('beforeend', capitalize(data.room));\r\n    membersCount.innerHTML = `${data.users.length} members`;\r\n    data.users.forEach((user, i) => {\r\n        // if(nameList){ // Check if username already exists\r\n        members.insertAdjacentHTML('beforeend',`<li>${user.username}</li>`);\r\n        // }\r\n    });\r\n}\r\n\r\nfunction capitalize(string) {\r\n    return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n    \r\n// Init Notfication\r\nfunction spawnNotification(theBody,theIcon,theTitle) {\r\n    if(!document.hasFocus()){\r\n        window.Push.create(theTitle, {\r\n        body: theBody,\r\n        icon: 'https://image.flaticon.com/teams/slug/freepik.jpg',\r\n        timeout: 4000,\r\n        onClick: function () {\r\n            window.focus();\r\n            this.close();\r\n                }\r\n            });\r\n        }\r\n    }   \r\n\r\nfunction updateScroll(){\r\n    const $chat = document.querySelector('#chat');\r\n    $chat.scrollTop = $chat.scrollHeight;\r\n}\r\n\r\n\r\n// Show typing status\r\nexport const Typing = ()=>{\r\n    socket.emit('typing', GetCookie(\"username\"));\r\n};\r\n\r\nsocket.on('typing', (data)=>{\r\n    const $typing = document.querySelector('#typing'),\r\n        membersCount = document.getElementById(\"membersCount\");\r\n\r\n    membersCount.classList.add(\"d-none\");\r\n    $typing.innerHTML = data+' is typing...';\r\n    clearTimeout(timer);\r\n    timer = setTimeout(()=>{\r\n            $typing.innerHTML ='';\r\n            membersCount.classList.remove(\"d-none\");\r\n        }, 700);\r\n});\r\n\r\nsocket.on(\"roomUsers\", data => {\r\n    updateRoomDetails(data);\r\n});\r\n\r\n// File upload\r\nexport const imgUpload =  (e)=>{\r\n    const $imgUpload = document.querySelector('#imgUploadInput');\r\n    var data = new FormData();\r\n    if($imgUpload.files[0] != null){\r\n        data.append('img', $imgUpload.files[0]);\r\n        data.append('username', GetCookie('username'));\r\n\r\n        fetch('//'+GetCookie('server')+'/upload', {\r\n            body: data,\r\n            method: 'POST',\r\n        })\r\n        .then(res => res.json())\r\n        .then(function(data){\r\n            // alert(data.message);\r\n        })\r\n        .catch(() => {\r\n            alert('error');\r\n        });\r\n    }\r\n    console.log($imgUpload.files[0]);\r\n   \r\n};\r\n\r\nexport function messageSubmit(e){\r\n    const $message = document.querySelector('#message');\r\n    var data = {}\r\n    e.preventDefault();\r\n    data = {msg: $message.value, user:GetCookie(\"username\")};\r\n    socket.emit('send message', data);\r\n    $message.value = \"\";\r\n}\r\n\r\nsocket.on('new message', (data)=>{\r\n    const $chat = document.querySelector('#chat');\r\n    if(data.user === GetCookie(\"username\")){\r\n        $chat.insertAdjacentHTML('beforeend',\r\n            `<div class=\"float-right own-msg bg-secondary\">\r\n                <strong class=\"username\">${data.user}</strong>\r\n                <p class=\"text-light\">${data.msg} <small>${data.time}</small></p>\r\n            </div>\r\n            <div class=\"clearfix\"></div>`);\r\n    }else{\r\n        $chat.insertAdjacentHTML('beforeend','<div class=\"bg-primary float-left msg\"><p class=\"text-light\"><strong>'+data.user+'</strong>: '+data.msg+'</p></div><div class=\"clearfix\"></div>');\r\n        // updateUserHead(data.user);\r\n        spawnNotification('You Got new Message','https://image.flaticon.com/teams/slug/freepik.jpg','New Message');\r\n    }\r\n    updateScroll()\r\n});\r\nsocket.on('show image', (data)=>{\r\n    const $chat = document.querySelector('#chat');\r\n    if(data.user === GetCookie(\"username\")){\r\n        $chat.insertAdjacentHTML('beforeend',\r\n            `<div class=\"float-right own-msg bg-secondary\">\r\n                <a data-fancybox=\"ownGallery\" href=\"//${GetCookie('server')}/uploads/${data.msg}\">\r\n                    <figure class=\"figure\">\r\n                        <img id=\"img\" src=\"//${GetCookie('server')}/uploads/${data.msg}\">\r\n                        <figcaption class=\"figure-caption d-flex justify-content-between\">\r\n                            <strong>${data.user}</strong> \r\n                            <small>${data.time}</small>\r\n                        </figcaption>\r\n                    </figure>\r\n                </a>\r\n            </div>\r\n            <div class=\"clearfix\"></div>`);\r\n    }else{\r\n        $chat.insertAdjacentHTML('beforeend',\r\n            `<div class=\"bg-primary float-left msg\">\r\n                <a data-fancybox=\"gallery\" href=\"//${GetCookie('server')}/uploads/${data.msg}\">\r\n                    <figure class=\"figure\">\r\n                        <img id=\"img\" src=\"//${GetCookie('server')}/uploads/${data.msg}\">\r\n                        <figcaption class=\"figure-caption d-flex justify-content-between\">\r\n                            <strong>${data.user}</strong>\r\n                            <small>${data.time}</small>\r\n                        </figcaption>\r\n                    </figure>\r\n                </a>\r\n            </div>\r\n            <div class=\"clearfix\"></div>`);\r\n    }\r\n    updateScroll()\r\n});\r\n","import React, { Component } from \"react\";\r\nimport {GetCookie} from \"../util/util\"\r\nimport { socket, messageSubmit, Typing, imgUpload } from \"../util/socket\";\r\n\r\nclass Room extends Component {\r\n\tcomponentDidMount() {\r\n\t\tconst {room} = this.props;\r\n\r\n\t\tsocket.connect();\r\n\r\n\t\tsocket.emit(\"joinRoom\", {\r\n\t\t\tusername: GetCookie(\"username\"),\r\n\t\t\troom\r\n\t\t});\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tconst {room} = this.props;\r\n\t\tif(prevProps.room !== room){\r\n\t\t\tsocket.disconnect();\r\n\t\t\tsocket.connect();\r\n\r\n\t\t\tsocket.emit(\"joinRoom\", {\r\n\t\t\t\tusername: GetCookie(\"username\"),\r\n\t\t\t\troom\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tsocket.disconnect();\r\n\t}\r\n\r\n\trender() {\r\n        const { logout, room } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div id=\"chat-h\" className=\"fixed-top\">\r\n                    <span onClick={logout} className=\"btn btn-danger float-right\">Logout</span>\r\n\t\t\t\t\t<div id=\"roomHead\">\r\n\t\t\t\t\t\t<p id=\"roomName\">{room}</p>\r\n\t\t\t\t\t\t<small id=\"membersCount\" data-toggle=\"modal\" data-target=\"#membersModal\"></small>\r\n\t\t\t\t\t\t<small id=\"typing\"></small>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{/* Members Modal */}\r\n\t\t\t\t<div className=\"modal fade\" id=\"membersModal\" tabIndex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\"\r\n\t\t\t\t\taria-hidden=\"true\">\r\n\t\t\t\t\t<div className=\"modal-dialog\" role=\"document\">\r\n\t\t\t\t\t\t<div className=\"modal-content\">\r\n\t\t\t\t\t\t\t<div className=\"modal-header\">\r\n\t\t\t\t\t\t\t\t<h5 className=\"modal-title\" id=\"exampleModalLabel\">\r\n\t\t\t\t\t\t\t\t\tRoom Members\r\n\t\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t\t<button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n\t\t\t\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"modal-body\">\r\n\t\t\t\t\t\t\t\t<ul id=\"members\"></ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"modal-footer\">\r\n\t\t\t\t\t\t\t\t<button type=\"button\" className=\"btn btn-primary\" data-dismiss=\"modal\">\r\n\t\t\t\t\t\t\t\t\tClose\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{/* Members Modal:END */}\r\n\r\n\t\t\t\t<div id=\"messageArea\" className=\"container row\">\r\n\t\t\t\t\t<ul className=\"chat\" id=\"chat\"></ul>\r\n\t\t\t\t\t<div className=\"fixed-bottom row justify-content-md-center\">\r\n\t\t\t\t\t\t<form\r\n\t\t\t\t\t\t\tonSubmit={messageSubmit}\r\n\t\t\t\t\t\t\tid=\"messageForm\"\r\n\t\t\t\t\t\t\tclassName=\"col col-md-8 row\"\r\n\t\t\t\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<label className=\"sr-only\">Enter Message</label>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tonInput={Typing}\r\n\t\t\t\t\t\t\t\tname=\"message\"\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\t\t\tid=\"message\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Enter Message\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn btn-primary\"\r\n\t\t\t\t\t\t\t\tid=\"msg-submit\"\r\n\t\t\t\t\t\t\t\tvalue=\"Send\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{/* Image sharing */}\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\tid=\"imgBtn\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn btn-primary\"\r\n\t\t\t\t\t\t\t\thtmlFor=\"imgUploadInput\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t&#9974;\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tonChange={imgUpload}\r\n\t\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\tname=\"img\"\r\n\t\t\t\t\t\t\t\tid=\"imgUploadInput\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<iframe\r\n\t\t\t\t\ttitle=\"background\"\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\theight: \"100%\",\r\n\t\t\t\t\t\ttop: \"0\",\r\n\t\t\t\t\t\tborder: \"none\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tsrc=\"%PUBLIC_URL%/bg/index.html\"\r\n\t\t\t\t></iframe>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Room;\r\n"],"sourceRoot":""}